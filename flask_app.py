"""
api.py
"""
from flask import Flask, render_template
from flask_pymongo import PyMongo
from app.model.flask.flask_model import *

import configuration_file as cfg

app = Flask(__name__)
app = Flask(__name__, template_folder='app/view/templates/')

app.config["MONGO_URI"] = cfg.mongo_config["client"] + "/" + cfg.mongo_config["db_name"]
mongo = PyMongo(app)

@app.route('/malware')
def malware():
    malwares_to_display = malware_model(mongo.db)
    return render_template('malware.html', malware_collection=malwares_to_display)

@app.route('/malware/<id>')
def get_one_malware(id):
    tempMalware = get_one_malware_model(mongo.db, id)
    return render_template('malware_id.html', malware=tempMalware)

@app.route('/ip')
def ip():
    ips_to_display = ip_model(mongo.db)
    return render_template('ip.html', ip_collection=ips_to_display)

@app.route('/ip/<id>')
def get_one_ip(id):
    tempIP = get_one_ip_model(mongo.db, id)
    return render_template('ip_id.html', ip=tempIP)

@app.route('/vt')
def vt():
    vts_to_display = vt_model(mongo.db)
    return render_template('vt.html', vt_collection=vts_to_display)

@app.route('/vt/<id>')
def get_one_vt(id):
    tempVT = get_one_vt_model(mongo.db, id)
    return render_template('vt_id.html', vt=tempVT)

@app.route('/label')
def label():
    labels_to_display = label_model(mongo.db)
    return render_template('label.html', label_collection=labels_to_display)

@app.route('/label/<id>')
def get_one_label(id):
    tempLabel = get_one_label_model(mongo.db, id)
    return render_template('label_id.html', label=tempLabel)

@app.route('/gridfs')
def gridfs_file():
    f_to_display = gridfs_file_model(mongo.db)
    return render_template('gridfs.html', gridfs_collection=f_to_display)

@app.route('/get_malwares_from_ip/<ip>')
def get_malware_from_ip(ip):
    malware_to_display = get_malware_from_ip_model(mongo.db, ip)
    return render_template('malware_ip.html', malware_ip=malware_to_display, ip=ip)

@app.route('/get_hash_malware/<type_hash>/<hash_value>')
def get_hash_malware(type_hash, hash_value):
    malware_to_display, ip_to_display = get_hash_malware_model(mongo.db, type_hash, hash_value)
    return render_template('hash.html', hash_malware=malware_to_display, hash_ip=ip_to_display, type=type_hash, hash=hash_value)

@app.route('/get_label_malware/<label>')
def get_label_malware(label):
    malware_to_display = get_label_malware_model(mongo.db, label)
    return render_template('malware_label.html', malware_label=malware_to_display, label=label)

app.run()
