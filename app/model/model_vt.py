"""
model_vt.py
"""
#!/usr/bin/env python
# model_view_controller.py
from collections import OrderedDict
import sys

class ModelVT():
    """
    empty
    """

    def __init__(self, db):
        self._db = db

    def create_vt_collection(self):
        """
        add atribute in virus total collection
        Params:
        - db
        Returns:
        - none
        """

        self._db.vt_collection.drop()
        self._db.create_collection("vt_collection")

        vexpr = {
            "$jsonSchema": {
                "bsonType": "object",
                "required": ["id_malware_vt"],
                "properties": {
                    "scan_id_vt" : {
                        "bsonType" : "string"
                    },
                    "total_scan_vt" : {
                        "bsonType": "int",
                    },
                    "positives_vt" : {
                        "bsonType": "int",
                    },
                    "resource_vt" : {
                        "bsonType": "string",
                    },
                    "response_vt" : {
                        "bsonType": "int",
                    },
                    "scan_date_vt" : {
                        "bsonType": "string",
                    },
                    "permalink_vt" : {
                        "bsonType": "string",
                    },
                    "sha256_vt" : {
                        "bsonType": "string",
                    },
                    "sha1_vt" : {
                        "bsonType": "string",
                    },
                    "md5_vt" : {
                        "bsonType": "string",
                    },
                    "entire_report_vt" : {
                        "bsonType": "string",
                    },
                    "id_malware_vt" : {
                        "bsonType": "string",
                    }
                }
            }
        }

        cmd = OrderedDict([('collMod', 'vt_collection'),
                           ('validator', vexpr),
                           ('validationLevel', 'moderate')])

        self._db.command(cmd)

        self._db.vt_collection.create_index("scan_id_vt")

    def get_vt_collection(self):
        """
        empty
        """
        return self._db["vt_collection"]

    def add_vt_collection(self, scan_id_vt, total_scan_vt, positives_vt, resource_vt, response_vt, scan_date_vt, permalinks_vt, sha256_vt, md5_vt, sha1_vt, entire_report_vt, id_malware_vt):
        """
        empty
        """
        try:
            query = {"scan_id_vt": scan_id_vt,
                     "total_scan_vt":total_scan_vt,
                     "positives_vt": positives_vt,
                     "response_vt":response_vt,
                     "resource_vt":resource_vt,
                     "scan_date_vt":scan_date_vt,
                     "permalinks_vt": permalinks_vt,
                     "sha256_vt": sha256_vt,
                     "sha1_vt": sha1_vt,
                     "md5_vt":md5_vt,
                     "entire_report_vt":entire_report_vt,
                     "id_malware_vt":id_malware_vt,
                    }
            self._db.vt_collection.insert_one(query)
        except:
            print("exc:", sys.exc_info())

    def select_one_vt_collection(self, scan_id_vt):
        """
        empty
        """
        return self._db.vt_collection.find_one({"scan_id_vt": scan_id_vt})

    def select_all_vt_collection(self):
        """
        empty
        """
        return self._db.vt_collection.find()

    def delete_one_vt_collection(self, scan_id_vt):
        """
        empty
        """
        self._db.vt_collection.deleteOne({"scan_id_vt": scan_id_vt})
