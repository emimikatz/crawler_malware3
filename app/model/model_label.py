"""
model_label.py
"""
#!/usr/bin/env python
# model_view_controller.py
from collections import OrderedDict
import sys

class ModelLabel():
    """
    empty
    """

    def __init__(self, db):
        self._db = db

    def create_label_collection(self):
        """
        add atribute in label collection
        Params:
        - db
        Returns:
        - none
        """

        self._db.label_collection.drop()
        self._db.create_collection("label_collection")

        vexpr = {
            "$jsonSchema": {
                "bsonType": "object",
                "required": ["id_malware_label"],
                "properties": {
                    "id_malware_label" : {
                        "bsonType": "string",
                    },
                    "label" : {
                        "bsonType": "string",
                    }
                }
            }
        }

        cmd = OrderedDict([('collMod', 'label_collection'),
                           ('validator', vexpr),
                           ('validationLevel', 'moderate')])

        self._db.command(cmd)
        self._db.label_collection.create_index("id_malware_label")

    def get_label_collection(self):
        """
        empty
        """
        return self._db["label_collection"]

    def add_label_collection(self, id_malware_label, output_avclassplusplus):
        """
        empty
        """
        try:
            query = {"id_malware_label": id_malware_label,
                     "label": output_avclassplusplus,
                    }
            self._db.label_collection.insert_one(query)
        except:
            print("exc:", sys.exc_info())

    def select_one_label_collection(self, id_malware_label):
        """
        empty
        """
        return self._db.label_collection.findOne({"id_label": id_malware_label})

    def select_all_label_collection(self):
        """
        empty
        """
        return self._db.label_collection.find()

    def delete_one_label_collection(self, id_malware_label):
        """
        empty
        """
        self._db.label_collection.deleteOne({"id_malware_label": id_malware_label})
