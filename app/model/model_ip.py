"""
model_ip.py
"""
#!/usr/bin/env python
# model_view_controller.py
from collections import OrderedDict
import sys

class ModelIP():
    """
    empty
    """

    def __init__(self, db):
        self._db = db

    def create_ip_collection(self):

        """
        add atribute in ip collection
        Params:
        - db
        Returns:
        - none
        """

        self._db.ip_collection.drop()
        self._db.create_collection("ip_collection")

        vexpr = {
            "$jsonSchema": {
                "bsonType": "object",
                "required": ["address_ip"],
                "properties": {
                    "id_malware_ip" : {
                        "bsonType": "string",
                    },
                    "address_ip" : {
                        "bsonType": "string",
                    },
                    "country_name_ip" : {
                        "bsonType": "string",
                    },
                    "continent_code_ip" : {
                        "bsonType": "string",
                    },
                    "continent_name_ip" : {
                        "bsonType": "string",
                    },
                    "country_code_ip" : {
                        "bsonType": "string",
                    },
                    "region_code_ip" : {
                        "bsonType": "string",
                    },
                    "region_name_ip" : {
                        "bsonType" : "string",
                    },
                    "city_ip" : {
                        "bsonType" : "string",
                    },
                    "zip_ip" : {
                        "bsonType" : "string",
                    },
                    "latitute_ip" : {
                        "bsonType" : "double",
                    },
                    "longitute_ip" : {
                        "bsonType" : "double",
                    },
                    "full_report_ip" : {
                        "bsonType" : "string",
                    },
                }
            }
        }

        cmd = OrderedDict([('collMod', 'ip_collection'),
                           ('validator', vexpr),
                           ('validationLevel', 'moderate')])

        self._db.command(cmd)
        self._db.ip_collection.create_index("address_ip")

    def get_ip_collection(self):
        """
        empty
        """
        return self._db["ip_collection"]

    def add_ip_collection(self, id_malware_ip, ip, country_name, country_code, continent_code, continent_name, region_name, region_code, city, zip, latitude, longitude, full_report):
        """
        empty
        """
        try:
            query = {"id_malware_ip": id_malware_ip,
                     "address_ip":ip,
                     "country_name_ip": country_name,
                     "country_code_ip":country_code,
                     "continent_name_ip":continent_name,
                     "continent_code_ip":continent_code,
                     "region_name_ip":region_name,
                     "region_code_ip":region_code,
                     "city_ip":city,
                     "zip_ip":zip,
                     "latitude_ip":latitude,
                     "longitude_ip":longitude,
                     "full_report_ip":full_report,
                    }
            self._db.ip_collection.insert_one(query)
        except:
            print("exc:", sys.exc_info())

    def select_one_ip_collection(self, id_malware_ip):
        """
        empty
        """
        return self._db.ip_collection.findOne({"id_malware_ip": id_malware_ip})

    def select_all_ip_collection(self):
        """
        empty
        """
        return self._db.ip_collection.find()

    def delete_one_ip_collection(self, id_malware_ip):
        """
        empty
        """
        self._db.ip_collection.deleteOne({"id_malware_ip": id_malware_ip})
