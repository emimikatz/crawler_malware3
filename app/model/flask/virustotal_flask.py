"""
virustotal_flask.py
"""
class VirusTotal():
    """A class for storing VirusTotal information"""

    def __init__(self, scan_id_vt=None, total_scan_vt=None, positives_vt=None, response_vt=None, resource_vt=None, scan_date_vt=None, permalinks_vt=None, sha256_vt=None, sha1_vt=None, md5_vt=None, entire_report_vt=None, id_malware_vt=None):
        self.scan_id_vt = scan_id_vt
        self.total_scan_vt = total_scan_vt
        self.positives_vt = positives_vt
        self.response_vt = response_vt
        self.resource_vt = resource_vt
        self.scan_date_vt = scan_date_vt
        self.permalinks_vt = permalinks_vt
        self.sha256_vt = sha256_vt
        self.sha1_vt = sha1_vt
        self.md5_vt = md5_vt
        self.entire_report_vt = entire_report_vt
        self.id_malware_vt = id_malware_vt


    def get_as_json(self):
        """ Method returns the JSON representation of the VirusTotal object,
        this can be saved to MongoDB """
        return self.__dict__


    @staticmethod
    def build_from_json(json_data):
        """ Method used to build VirusTotal objects from JSON data returned from MongoDB """
        if json_data is not None:
            try:
                return VirusTotal(json_data['scan_id_vt'],
                                  json_data['total_scan_vt'],
                                  json_data['positives_vt'],
                                  json_data['response_vt'],
                                  json_data['resource_vt'],
                                  json_data['scan_date_vt'],
                                  json_data['permalinks_vt'],
                                  json_data['sha256_vt'],
                                  json_data['sha1_vt'],
                                  json_data['md5_vt'],
                                  json_data['entire_report_vt'],
                                  json_data['id_malware_vt'])
            except KeyError as e:
                raise Exception("Key not found in json_data: {}".format(e))
        else:
            raise Exception("No data to create VirusTotal from!")
