import os
from threading import Thread

from app.controller import controller
from app.controller import utils

def main():
    """
    Fonction Main
    init, -- Clean the database
    run, -- Crawler runs, parses the csv file, collects information from the different files and stores them in the Mongo database
    """
    print("Enter 'run' to download files from urlhaus")
    print("Enter 'init' to initializate the database")

    input_user = input("Enter value\n")
    c = controller.Controller()
    request = utils.init_connection_urlhaus()

    if input_user == "init":
        c.initialisation()
    elif input_user == "run":
        Thread(target=c.periodic_vt, daemon=True).start()
        Thread(target=c.periodic_link, daemon=True).start()
        c.parse_csv_urlhaus(request)

if __name__ == '__main__':
    main()
